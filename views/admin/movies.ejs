<div class="flex items-center justify-between gap-2">
  <h1 class="text-2xl font-semibold">Movies</h1>
  <div class="flex gap-2">
    <a href="/admin" class="rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10 transition">Dashboard</a>
    <a href="/admin/settings" class="rounded-xl border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10 transition">Settings</a>
  </div>
</div>

<div class="mt-6 rounded-3xl border border-white/10 bg-white/5 p-4 sm:p-6">
  <div class="font-semibold">Add Movie</div>
  <form class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3" method="POST" action="/admin/movies/create">
    <input name="title" required placeholder="Title" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
    <input name="slug" placeholder="Slug (optional)" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
    <input name="year" placeholder="Year" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
    <input name="genre" placeholder="Genre" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
    <input name="posterUrl" placeholder="Poster URL" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
    <input name="backdropUrl" placeholder="Backdrop URL (optional)" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
    <textarea name="description" rows="2" placeholder="Description" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"></textarea>

    <input name="embedIdOrUrl" required placeholder="Embed ID atau Full URL"
           class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>

    <label class="flex items-center gap-2 text-sm text-zinc-300">
      <input type="checkbox" name="isPublished" checked> Published
    </label>

    <button class="sm:col-span-2 rounded-2xl bg-white text-zinc-900 font-semibold px-6 py-3 hover:opacity-90 transition">
      Create
    </button>
  </form>
</div>

<div class="mt-6 space-y-3">
  <% (movies || []).forEach(function(m){ %>
    <div class="rounded-3xl border border-white/10 bg-white/5 p-4 sm:p-6">
      <div class="flex items-start justify-between gap-3">
        <div class="flex gap-3">
          <img src="<%= m.posterUrl || 'https://placehold.co/200x300?text=Poster' %>" class="w-16 h-24 rounded-2xl object-cover border border-white/10 bg-white/5"
               onerror="this.src='https://placehold.co/200x300?text=Poster'"/>
          <div>
            <div class="font-semibold"><%= m.title %></div>
            <div class="text-sm text-zinc-400 mt-1">
              <span class="mr-2">/<%= m.slug %></span>
              <span class="mr-2">üëÅÔ∏è <%= m.views %></span>
              <span class="px-2 py-1 rounded-full border border-white/10 bg-white/5 text-xs"><%= m.isPublished ? "Published" : "Hidden" %></span>
            </div>
          </div>
        </div>

        <form method="POST" action="/admin/movies/<%= m.id %>/delete" onsubmit="return confirm('Delete movie?')">
          <button class="rounded-xl border border-red-500/20 bg-red-500/10 text-red-200 px-3 py-2 text-sm hover:bg-red-500/20 transition">
            Delete
          </button>
        </form>
      </div>

      <details class="mt-3">
        <summary class="cursor-pointer text-sm text-zinc-300/90">Edit</summary>
        <form class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3" method="POST" action="/admin/movies/<%= m.id %>/update">
          <input name="title" value="<%= m.title %>" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
          <input name="year" value="<%= m.year || '' %>" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
          <input name="genre" value="<%= m.genre || '' %>" class="rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
          <label class="flex items-center gap-2 text-sm text-zinc-300">
            <input type="checkbox" name="isPublished" <%= m.isPublished ? "checked" : "" %> > Published
          </label>

          <input name="posterUrl" value="<%= m.posterUrl || '' %>" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
          <input name="backdropUrl" value="<%= m.backdropUrl || '' %>" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>
          <textarea name="description" rows="2" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"><%= m.description || '' %></textarea>
          <input name="embedIdOrUrl" value="<%= m.embedIdOrUrl %>" class="sm:col-span-2 rounded-2xl border border-white/10 bg-zinc-950/40 px-4 py-3 outline-none"/>

          <button class="sm:col-span-2 rounded-2xl bg-white text-zinc-900 font-semibold px-6 py-3 hover:opacity-90 transition">
            Update
          </button>
        </form>
      </details>
    </div>
  <% }) %>
</div>
